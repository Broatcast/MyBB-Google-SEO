---------------------------------------------------------------------------
          Google Search Engine Optimization plugin for MyBB
               Copyright (C) 2008, 2009 Andreas Klauer
                   <Andreas.Klauer@metamorpher.de>
                            GPL version 3
---------------------------------------------------------------------------

      THIS PLUGIN IS STILL IN BETA STAGE. USE AT YOUR OWN RISK.

---------------------------------------------------------------------------

                                README

1. About this plugin
2. Features
3. Installation Instructions
4. Uninstalling Instructions
5. Advanced Usage

---------------------------------------------------------------------------

1. About this plugin

   The development of this plugin started when Google released a document
   called "Google's Search Engine Optimization starter guide" in Nov 2008.

   The goal of this plugin is to implement SEO in MyBB according to the
   guidelines presented in that document, to make MyBB more friendly to
   both users and search engines.

   This plugin requires Apache with mod_rewrite, MySQL, PHP with mbstring,
   and MyBB 1.4. MySQL 5, PHP 5 is highly recommended. Unfortunately, some
   core files have to be modified for the plugin to work.

   This plugin is free open source software (GPL). This means that you can
   download the plugin for free, modify it to your liking, and you do not
   have to put any copyright or backlinks on your page.

---------------------------------------------------------------------------

2. Features

   The plugin currently supports the following features:

   - Google SEO 404:
     * error pages return 404 error code instead of 200
     * add Google's 404 widget to 404 error pages
     * custom 404 error pages

   - Google SEO Meta:
     * generate description meta tags for forums / threads / etc.

   - Google SEO Redirect:
     * redirect old URLs to new URLs
     * this avoids URL breakage and double content

   - Google SEO Sitemap:
     * dynamic generation of XML Sitemaps
     * lets search engines find your content without crawling

   - Google SEO URL:
     * replace standard id based URLs (e.g. showthread.php?tid=12345)
       with name based URLs (e.g. Thread-some-subject)
     * UTF-8 in URLs is supported
     * uniquifier is applied for non-unique URLs (see 5. Advanced Usage)

---------------------------------------------------------------------------

3. Installation Instructions

   Upload google_seo.php, google_seo.txt and the google_seo folder
   to inc/plugins of your MyBB installation.

   You can then install and activate the plugin in your Admin CP.
   The plugin will display a status information on the plugins page.
   You can enable Google SEO features in the Google SEO setting groups.

   Several features require you to make changes to MyBB. The status
   information on the plugins page will notify you of these, once you
   enable the features. The changes have to be applied manually.

   - Google SEO 404:

     For custom errorpages to work, you have to add the following
     to your .htaccess

       ErrorDocument 404 /MyBB/misc.php?google_seo_error=404

     This will cause 404 errors outside of MyBB show up as MyBB
     error messages, using your boards layout. Please note that
     Google SEO 404 has to be enabled in your configuration first.

   - Google SEO Meta:

     Go to Admin CP, Templates & Style, and add the following line
     to your headerinclude template:

       {$google_seo_meta}

   - Google SEO Sitemap:

     Add this rewrite rule to your .htaccess:

       RewriteRule ^sitemap-([^./]+)\.xml$ misc.php?google_seo_sitemap=$1 [L,QSA,NC]

     Tell search engines about your sitemap (e.g. Google Webmaster Tools).
     You can also add this line to your robots.txt:

       Sitemap: http://yoursite/mybb/sitemap-index.xml

   - Google SEO URL:

     Add these rewrite rules to your .htaccess:

       RewriteRule ^Forum-([^./]+)$ forumdisplay.php?google_seo_forum=$1 [L,QSA,NC]
       RewriteRule ^Thread-([^./]+)$ showthread.php?google_seo_thread=$1 [L,QSA,NC]
       RewriteRule ^Announcement-([^./]+)$ announcements.php?google_seo_announcement=$1 [L,QSA,NC]
       RewriteRule ^User-([^./]+)$ member.php?action=profile&google_seo_user=$1 [L,QSA,NC]
       RewriteRule ^Calendar-([^./]+)$ calendar.php?google_seo_calendar=$1 [L,QSA,NC]
       RewriteRule ^Event-([^./]+)$ calendar.php?action=event&google_seo_event=$1 [L,QSA,NC]

     You will also need modify inc/functions.php.

     For your convenience, the modified version of MyBB 1.4.4 functions.php
     is included with this plugin. For other versions, please use the patch
     or apply the following changes manually:

     Find:
       function get_profile_link($uid=0)
       {

     Append:
       if(function_exists("google_seo_url_profile"))
       {
           $link = google_seo_url_profile($uid);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_announcement_link($aid=0)
       {

     Append:
       if(function_exists("google_seo_url_announcement"))
       {
           $link = google_seo_url_announcement($aid);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_forum_link($fid, $page=0)
       {

     Append:
       if(function_exists("google_seo_url_forum"))
       {
          $link = google_seo_url_forum($fid, $page);

          if($link)
          {
              return $link;
          }
       }

     Find:
       function get_thread_link($tid, $page=0, $action='')
       {

     Append:
       if(function_exists("google_seo_url_thread"))
       {
           $link = google_seo_url_thread($tid, $page, $action);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_post_link($pid, $tid=0)
       {

     Append:
       if(function_exists("google_seo_url_post"))
       {
           $link = google_seo_url_post($pid, $tid);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_event_link($eid)
       {

     Append:
       if(function_exists("google_seo_url_event"))
       {
           $link = google_seo_url_event($eid);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_calendar_link($calendar, $year=0, $month=0, $day=0)
       {

     Append:
       if(function_exists("google_seo_url_calendar"))
       {
           $link = google_seo_url_calendar($calendar, $year, $month, $day);

           if($link)
           {
               return $link;
           }
       }

     Find:
       function get_calendar_week_link($calendar, $week)
       {

     Append:
       if(function_exists("google_seo_url_calendar_week"))
       {
           $link = google_seo_url_calendar_week($calendar, $week);

           if($link)
           {
               return $link;
           }
       }

---------------------------------------------------------------------------

4. Uninstalling Instructions

   If you want to redirect Google SEO URLs back to stock MyBB URLs,
   just upload the original, unmodified inc/functions.php, but make
   sure to keep Google SEO URL and Google SEO Redirect enabled.

   This way Google SEO stays installed and will continue to translate
   page names to IDs, allowing Google SEO Redirect to redirect the
   Google SEO URLs back to stock MyBB URLs.

   This gives users and search engines time to adapt to the change.

   To uninstall completely, undo all the changes you made on install,
   then go to Admin CP -> Plugins and click 'Deactivate'.

   This way the Google SEO URLs will end up in 404 error land.

   If you click 'Uninstall' all data regarding Google SEO URLs will
   be lost. Old URLs for renamed threads / forums will no longer be
   known when you reinstall.

---------------------------------------------------------------------------

5. Advanced Usage

   Uniquifier:

     The Google SEO URL uniquifier is applied to URLs that would otherwise
     not be unique (and thus result in threads that are not accessible).
     Collision testing (for example for two threads with the same title)
     is done only once, therefore the uniquifier must result in a truly
     unique URL that can not possibly collide with anything else.

     A good uniquifier needs to fulfill these two criteria:

       1) contain the items unique {$id}
       2) contain punctuation that cannot occur in non-uniquified URLs

     Early versions of Google SEO used {$url}-{$id} as uniquifier and
     therefore did not fulfill criteria 2). This could lead to collisions
     in rare cases, for example:

       ID: 1, Title: Unique, URL: Thread-Unique
       ID: 2, Title: Unique 3, URL: Thread-Unique-3
       ID: 3, Title: Unique, URL: Thread-Unique-3 (same as Thread 2)

     Thread 3 collides with Thread 1 (both are called Unique), so the
     uniquifier is applied. This results in Unique-3. However, there
     already happens to be a thread called Unique 3. Doesn't work.

     With the new uniquifier {$url}{$separator}{$separator}{$id},
     the uniquified URL will be Thread-Unique--3. Because the id is
     already unique, and other URLs can't contain -- (title punctuation
     is reduced to one single separator, not two), that makes the URL
     as a whole unique.

     If you use a custom uniquifier, make sure it fulfills the two
     criteria listed above. Be aware that special punctuation characters
     like : or @ or / or space can break your URLs.

   robots.txt:

     It's a good idea to prevent robots from indexing parts of your page,
     such as the calendar (Google doesn't like calendars because they do
     infinite links into the past and the future), or pages that would
     double content (archive mode), or pages that are just not interesting
     for search engines (rating threads, sending private messages, ...).

     This plugin comes with a robots.txt.example file that you can adapt
     to your needs. You will have to modify this file before using it if
     your board does not reside in the root directory of your (sub)domain.

   Title tags:

     Make sure that your template gives a unique title to each page.
     MyBB does this well by default, except for forum display pages.

     In Admin CP -> Templates & Style -> Templates, find the 'forumdisplay'
     template and find this line:

       <title>{$mybb->settings['bbname']} - {$foruminfo['name']} </title>

     Change it to:

       <title>{$foruminfo['name']} - {$mybb->settings['bbname']}</title>

     Having the bbname in the title on every page is optional, if you
     have a properly named domain you can even leave it out entirely.
     If you decide to keep it, make sure that your template puts it as
     last element in every page title.

---------------------------------------------------------------------------
